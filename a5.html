<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, maximum-scale=1.0" />

    <title>Liam's HCDE 439 Physical Computing Page!</title>

    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <h1>Higher Voltage & Transistors!</h1>
    <div class="header">
      <video width="100%" height="auto" controls autoplay muted>
        <source src="./A5-Folder/a5Vid.mp4" type="video/mp4">
      </video>
    </div>
    <div>
      <p>This is a video of my Arduino circuit. Simplified, there is a PIR that triggers an LED light strip to turn on..
      </p>
    </div>
    <br>
    <br>
    <div>
      <h2>The Schematic & Calculations:</h2>
      <img width="80%" height="auto" src="./A5-Folder/a5schematic.jpg"/>
      <p>This is my written out schematic. The PIR and LED Strip do not need resistors. The PIR and LED Strip are powered by different power supplies.
      </p>
    </div>
    <br>
    <br>
    <div>
      <h2>Firmware</h2>
        <pre>
          <code>//loading in library for PIR
            #include "PIR.h"
            //making PIR object P
            PIR P;
            
            //make brightness int
            int brightness = 0;
            //make checker int variable for PIR 
            int lastVal;
            //make checker int var for PIR
            int currentVal;
            //make brightness level array for PIR
            int blvl[] = {25, 150, 255};
            
            
            //setup code runs once upon startup
            void setup() {
              //adding PIR to pin 10
              P.add(10);
              //set pin 10 to output mode
              pinMode(9, OUTPUT);
            }
            
            //loop runs repeatedly
            void loop() {
              //checks if PIR detects movement
              currentVal = P.read();
                //check to make sure light only turns on per each time the PIR detects movement, not necessarily as long as the PIR reads "HIGH/1"
                if(currentVal == 1 && currentVal != lastVal){
                  //makes pin 9 output "brightness" amount of voltage. This goes to the transistor, which makes the LEDs
                  //proportionally bright
                  analogWrite(9, blvl[brightness]);
                  //brightness int increases to cycle through the array blvl
                  brightness++;
                  //light stays on for 5000ms
                  delay(5000);
                  //turns light off after delay
                  analogWrite(9, 0);
                  //checks if brightness is greater than max of blvl array
                  if(brightness >2){
                    //resets to avoid error
                    brightness = 0;
                  }
                }
              //makes currentVal lastVal to ensure if statement works
              lastVal = currentVal;
            }            
        </code>
      </pre>

      <p>
        This is my commented-out firmware that explains how the circuit works.
      </p>
    </div>
    
    <br>
    <br>
    <div>
      <h2>Final Circuit!</h2>
      <img width="80%" height="auto" src="./A5-Folder/a5Thumbnail.jpg"/>
      <p>This is a still image of my final circuit! The video at the top of the page does a better job showing what it actually does.</p>
    </div>
    <br>
    <br>
    <div>
      <h2>Additional Questions</h2>
      <br>
      <h3>1: What is the absolute maximum amount of current between pins 2 and 3?</h3>
      <p>According to the datasheet of the component,the maximum body diode forward current is 80A.</p>
      <br>
      <h3>2: Draw a schematic for a circuit with using at least your arduino, a DC motor, a flyback diode, and capacitors between power and ground. Find parts with datasheets you could use for each of these schematic components.</h3>
      <br>
      <pre>
      <code> 
          loop{
            //check if current value is 1, which is "movement"
            if(P.read() ==1){
              //delay for a while to make sure that the "HIGH/1" inputs stop if it's fake. 
              delay(500);
              if(P.read() == 1)
              //Do thing 
              //This will only be triggered if someone is still moving their hand after half a second
              //The the first check in this loop triggers when the PIR is set off the first time, the second if statement makes sure the reading is legit.
            }
          }
        </code>
      </pre>
      <p>The mix of pseudocode and "code" has explanations and justifications assuming that I'm using a PIR.</p>
      <br>
      <h3>3: Your input device is slightly noisy, leading the measurement to randomly deviate from the true measurement up or down by 10%. How can we address this? Answer in (pseudo)code.</h3>
      <img width="80%" height="auto" src="./A5-Folder/a5p3.png"/>
      <pre>
        <code>
          setup(){
            pinMode(1,2,4, and 5, OUTPUT);
          }
          loop{
            //both forward:
            digitalWrite(2 and 4, HIGH);
            digitalWrite(1 and 5, LOW);
            delay(3000);
            //both backward:
            digitalWrite(2 and 4, LOW);
            digitalWrite(1 and 5, HIGH);
            delay(3000);
            //alternate directions
            digitalWrite(2, HIGH);
            digitalWrite(1, LOW);
            digitalWrite(4, LOW);
            digitalWrite(5, HIGH);
            delay(3000);
            //alternate directions again
            digitalWrite(2, LOW);
            digitalWrite(1, HIGH);
            digitalWrite(4, HIGH);
            digitalWrite(5, LOW);
            delay(3000);
          }
        </code>
      </pre>
      <p>The mix of pseudocode and code has comments that explain my thinking. I'm also answering this question as if I was using a different input device that could give me more complex values that are not 0 or 1.</p>
    </div>
  </body>
</html>